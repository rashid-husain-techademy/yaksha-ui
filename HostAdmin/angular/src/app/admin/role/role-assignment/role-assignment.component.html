<mat-tab-group>
    <!-- Create Role Tab Menu -->
    <mat-tab label="Create Role">
        <form [formGroup]="roleCreationForm">
            <div class="card m-b-20 create-assessment-custom">
                <div class="card-body d-flex">
                    <div class="w-100">
                        <label for="" class="font-weight-bold">{{constants.roleName}}<span
                                class="text-danger">*</span></label>
                        <input type="text" formControlName="roleName" class="form-control"
                            placeholder={{constants.roleName}} maxlength="500">
                        <small class="form-text text-danger" *ngIf="!isFormValid('roleName', roleCreationForm)">
                            {{roleCreationFormValidationMessages.roleNameIsRequired}}
                        </small>
                    </div>
                </div>
                <div class="card-body d-flex align-items-end">
                    <div class="multi-select w-80">
                        <label for="" class="font-weight-bold">{{constants.features}}<span
                                class="text-danger">*</span></label>
                        <div class="d-flex align-items-end ">
                            <div class="w-50">
                                <ng-multiselect-dropdown formControlName="features" [settings]="dropdownSettings"
                                    [data]="featureList" (onSelect)="onSelectFeature($event)"
                                    (onDeSelect)="onDeSelectFeature($event)" (onSelectAll)="onSelectAllFeature()"
                                    (onDeSelectAll)="onDeSelectAllFeature()" placeholder={{constants.selectFeatures}}>
                                </ng-multiselect-dropdown>
                            </div>

                            <div class="text-center ">
                                <button type="button" class="btn btn-info add-role-btn" (click)="addOrUpdateRole(0)"
                                    [disabled]="roleCreationForm.invalid">{{constants.addRole}}</button>
                            </div>
                        </div>

                        <small class="form-text text-danger" *ngIf="!isFormValid('features', roleCreationForm)">
                            {{roleCreationFormValidationMessages.featuresShouldNotBeEmpty}}
                        </small>
                    </div>

                </div>
            </div>
            <table class="table table-striped border mt-4">
                <thead>
                    <tr>
                        <th>Roles</th>
                        <th>{{constants.action}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let role of tenantRoles?.tenantRoles">
                        <td>
                            {{role.roleName}}
                        </td>
                        <td>
                            <i class="ti-pencil text-info m-r-10 pointer cursor"
                                (click)="openEditRolePermissionModal(rolecontent, role)"></i>
                            <i class="ti-trash text-danger pointer cursor" (click)="deleteRolePermission(role)"></i>
                        </td>
                    </tr>
                    <div *ngIf="isNoRolesFound" class="text-center">
                        {{constants.noRolesAvailableUnderThisTenant}}
                    </div>
                </tbody>
            </table>
            <ng-template #rolecontent let-modal>
                <form [formGroup]="editRolePermissionForm">
                    <div class="modal-header">
                        <h4 class="modal-title">{{constants.editRole}}</h4>
                    </div>
                    <div class="modal-body">
                        <div class="w-100">
                            <label for="" class="font-weight-bold">{{constants.roleName}} <span
                                    class="text-danger">*</span></label>
                            <input type="text" class="form-control" formControlName="editRoleName"
                                placeholder={{constants.roleName}} maxlength="500">
                            <small class="form-text text-danger"
                                *ngIf="!isFormValid('editRoleName', editRolePermissionForm)">
                                {{roleCreationFormValidationMessages.roleNameIsRequired}}
                            </small>
                        </div>
                        <div class="w-100 multi-select">
                            <label for="" class="font-weight-bold">{{constants.features}}<span
                                    class="text-danger">*</span></label>
                            <ng-multiselect-dropdown [settings]="dropdownSettings" [data]="featureList"
                                (onSelect)="onEditSelectFeature($event)" (onDeSelect)="onEditDeSelectFeature($event)"
                                (onSelectAll)="onEditSelectAll()" (onDeSelectAll)="onEditDeSelectAll()"
                                placeholder={{constants.selectFeatures}} formControlName="editFeatures">
                            </ng-multiselect-dropdown>
                            <small class="form-text text-danger"
                                *ngIf="!isFormValid('editFeatures', editRolePermissionForm)">
                                {{roleCreationFormValidationMessages.featuresShouldNotBeEmpty}}
                            </small>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                            (click)="onRoleModalClose()">{{constants.close}}</button>
                        <button type="button" class="btn btn-info" (click)="updateRolePermission()"
                            [disabled]="editRolePermissionForm.invalid">{{constants.update}}</button>
                    </div>
                </form>
            </ng-template>
            <div class="d-flex justify-content-between p-2" *ngIf="!isNoRolesFound">
                <ngb-pagination [collectionSize]="roleTotalCount" [(page)]="rolePageIndex" [pageSize]="pageSize"
                    [maxSize]="maxSize" (pageChange)="loadRolePage()" [rotate]="true"
                    [ellipses]="false"></ngb-pagination>
            </div>
        </form>
    </mat-tab>

    <!-- Assign role tab menu -->
    <mat-tab label="Assign Role">
        <form [formGroup]="userRoleForm">
            <div class="card m-b-20 create-assessment-custom">
                <div class="card-body d-flex justify-content-between">
                    <div class="w-45  multi-select">
                        <label for="" class="font-weight-bold">{{constants.roleName}}<span
                                class="text-danger">*</span></label>
                        <ng-multiselect-dropdown [settings]="roleDropDownSettings" [data]="roles" formControlName="role"
                            placeholder={{constants.selectRole}}>
                        </ng-multiselect-dropdown>
                        <small class="form-text text-danger" *ngIf="!isFormValid('role', userRoleForm)">
                            {{roleCreationFormValidationMessages.roleRequired}}
                        </small>
                    </div>
                    <div class="w-45 multi-select">
                        <label for="" class="font-weight-bold">{{constants.email}}<span
                                class="text-danger">*</span></label>
                        <div class="d-flex align-items-end ">
                            <div class="w-90">
                                <ng-multiselect-dropdown [settings]="userDropDownSettings" [data]="filteredTenantUsers"
                                    formControlName="userList" placeholder={{constants.selectEmail}}>
                                </ng-multiselect-dropdown>
                            </div>
                            <div class="text-center ">
                                <button type="button" class="btn btn-info add-role-btn"
                                    (click)="assignOrUpdateUserRole()"
                                    [disabled]="userRoleForm.invalid">{{constants.assign}}</button>
                            </div>
                        </div>

                        <small class="form-text text-danger" *ngIf="!isFormValid('userList', userRoleForm)">
                            {{roleCreationFormValidationMessages.emailAddressRequired}}
                        </small>
                    </div>

                </div>
            </div>
            <table class="table table-striped border mt-4">
                <thead>
                    <tr>
                        <th>Roles</th>
                        <th>{{constants.action}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let roleUser of tenantRoleUsers?.tenantRoleUsers">
                        <td>
                            {{roleUser.roleName}}
                        </td>
                        <td>
                            <i class="ti-pencil text-info m-r-10 pointer cursor"
                                (click)="openEditUserRolePermissionModal(assignrolecontent, roleUser)"></i>
                            <i class="ti-trash text-danger pointer cursor" (click)="deleteRolePermission(roleUser)"></i>
                        </td>
                    </tr>
                    <div *ngIf="isNoRoleUsersFound" class="text-center">
                        {{constants.noRolesAvailableUnderThisTenant}}
                    </div>
                </tbody>
            </table>
            <ng-template #assignrolecontent let-modal>
                <form [formGroup]="userRoleEditForm">
                    <div class="modal-header">
                        <h4 class="modal-title">{{constants.editRole}}</h4>
                        <!-- <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"><i class="mdi mdi-close"></i></button> -->
                    </div>
                    <div class="modal-body">
                        <p>{{selectedRoleName}}</p>
                        <div class="w-100 multi-select">
                            <label for="" class="font-weight-bold">{{constants.email}}<span
                                    class="text-danger">*</span></label>
                            <ng-multiselect-dropdown [settings]="userDropDownSettings" [data]="customUserList"
                                formControlName="editUsers" placeholder={{constants.selectEmail}}>
                            </ng-multiselect-dropdown>
                            <small class="form-text text-danger" *ngIf="!isFormValid('editUsers', userRoleEditForm)">
                                {{roleCreationFormValidationMessages.emailAddressRequired}}
                            </small>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                            (click)="onRoleModalClose()">{{constants.close}}</button>
                        <button type="button" class="btn btn-info" (click)="assignOrUpdateUserRole()"
                            [disabled]="userRoleEditForm.invalid">{{constants.update}}</button>
                    </div>
                </form>
            </ng-template>
            <div class="d-flex justify-content-between p-2" *ngIf="!isNoRoleUsersFound">
                <ngb-pagination [collectionSize]="roleUserTotalCount" [(page)]="roleUserPageIndex" [pageSize]="pageSize"
                    [maxSize]="maxSize" (pageChange)="loadRoleUserPage()" [rotate]="true" [ellipses]="false">
                </ngb-pagination>
            </div>
        </form>
    </mat-tab>
</mat-tab-group>