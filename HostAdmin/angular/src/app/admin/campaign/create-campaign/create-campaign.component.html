<div class="assign-campaign d-flex align-items-center justify-content-between m-b-20">
    <h3 class="page-title m-0" *ngIf="!isEdit">{{constants.createDrive}}</h3>
    <h3 class="page-title m-0" *ngIf="isEdit">{{constants.editDrive}}</h3>
</div>
<form [formGroup]="createCampaignForm">
    <div class="card">
        <div class="card-body d-flex">
            <div class="m-r-20 w-20" *ngIf="isSuperAdmin">
                <label class="font-weight-bold">{{constants.selectTenant}}<span class="text-danger">*</span></label>
                <ng-multiselect-dropdown (onSelect)="onSelectTenant($event)" (onDeSelect)="OnTenantDeselect()"
                    formControlName="tenantId" [placeholder]="constants.selectTenant"
                    [settings]="singleDropdownSettings" [data]="tenants" [disabled]="isEdit">
                </ng-multiselect-dropdown>
                <small class="form-text text-danger" *ngIf="!isFormValid('tenantId')">
                    {{createCampaignFormValidationMessages.tenantId.required}}
                </small>
            </div>
            <div [ngClass]="isSuperAdmin ? 'm-r-20 w-75' : 'w-100'">
                <label for="" class="font-weight-bold">{{constants.driveTitle}}<span
                        class="text-danger">*</span></label>
                <input type="text" class="form-control" [placeholder]="constants.driveTitle" formControlName="name"
                    maxlength="500">
                <small class="form-text text-danger" *ngIf="!isFormValid('name')">
                    {{createCampaignFormValidationMessages.name.required}}
                </small>
            </div>
        </div>
    </div>
    <div class="card m-b-20">
        <div class="card-body">
            <label for="" class="font-weight-bold">{{constants.description}}</label>
            <quill-editor [styles]="{height: '150px'}" formControlName="description"
                placeholder="{{constants.enterTheDescriptionHere}}"></quill-editor>
        </div>
    </div>
    <div class="card m-b-20">
        <div class="card-body">
            <label for="" class="font-weight-bold">{{constants.instructions}}</label>
            <quill-editor [styles]="{height: '150px'}" formControlName="instructions"
                placeholder="{{constants.enterTheInstructionsHere}}"></quill-editor>
        </div>
    </div>
    <div class="m-b-150">
        <div class="card" formArrayName="modules">
            <div *ngFor="let module of modules.controls; let i = index" [formGroupName]="i">
                <div class="card-body create-campaign-custom m-b-20">
                    <div class="d-flex">
                        <div class="col">
                            <h4>Level <span>{{i+1}}</span></h4>
                            <div class="row d-flex">
                                <div class="w-40 m-r-20 multi-select"
                                    *ngIf="!(isEdit && module.get('isDisabled').value)">
                                    <label for="" class="font-weight-bold">{{constants.searchByCategory}} <span
                                            class="text-danger">*</span></label>
                                    <ng-multiselect-dropdown (onSelect)="getAssessmentsByCategory($event , i)"
                                        (onDeSelect)="OnCategoryDeselect(i)" [data]="categories[i]"
                                        [selectedItems]="category" [placeholder]="constants.selectCategory"
                                        [settings]="singleDropdownSettings" [disabled]="module.get('isDisabled').value"
                                        formControlName="category">
                                    </ng-multiselect-dropdown>
                                    <small class="form-text text-danger"
                                        *ngIf="isFormSubmitTriggered && module.get('category').hasError('required')">
                                        {{createCampaignFormValidationMessages.categoryId.required}}
                                    </small>
                                </div>
                                <div class="w-50">
                                    <label for="" class="font-weight-bold">{{constants.assessmentTitle}} <span
                                            class="text-danger">*</span></label>
                                    <ng-multiselect-dropdown [data]="assessments[i]"
                                        [placeholder]="constants.selectAssessment"
                                        [settings]="singleDropdownSettingsAssessment" formControlName="assessment"
                                        [disabled]="module.get('isDisabled').value">
                                    </ng-multiselect-dropdown>
                                    <small class="form-text text-danger"
                                        *ngIf="isFormSubmitTriggered && module.get('assessment').hasError('required')">
                                        {{createCampaignFormValidationMessages.assessment.required}}
                                    </small>
                                </div>
                                <div class="d-flex  justify-content-start w-10 m-2"> <button type="button"
                                        class="btn btn-rounded" (click)="addmodule(i+1)" *ngIf="i+1 === modules.length">
                                        <i class="fa fa-plus"></i>
                                    </button>
                                    <button *ngIf="modules.length > 1" type="button" class="btn btn-rounded text-danger"
                                        (click)="deletemodule(i , module.value)">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="text-center m-b-20">
            <button type="button" class="btn btn-secondary m-r-20" (click)="cancel()">{{constants.cancel}}</button>
            <button type="button" class="btn btn-info" (click)="saveCampaign(createCampaignForm.value)">{{isEdit ?
                constants.update : constants.save}}</button>
        </div>
    </div>
</form>